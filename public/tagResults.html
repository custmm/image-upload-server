<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Ɐ휴욱슈욱Ɐ >> #{{tag}} 관련 게시물</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    h2 {
      color: #1da1f2;
    }

    .post-list {
      list-style: none;
      padding: 0;
    }

    .post-list li {
      background: #f7f7f7;
      padding: 15px;
      margin-bottom: 10px;
      border-left: 5px solid #1da1f2;
    }

    .post-list li a {
      color: #333;
      text-decoration: none;
    }

    .post-list li a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
    <button class="back-button" onclick="window.location.href='preview.html'">뒤로가기</button>
        <h2>#{{tag}} 관련 게시물</h2>
    <ul class="post-list">
        {{#each posts}}
        <li>
            <a href="/post/{{this.id}}">
            {{this.file_description}}
            </a>
        </li>
        {{/each}}
        </ul>
        <script>
        document.addEventListener("DOMContentLoaded", async () => {
        const params = new URLSearchParams(location.search);
        const tag = new URLSearchParams(location.search).get("tag");


        if (!tag) return;

        try {
            const res = await fetch(`/api/search?tag=${encodeURIComponent(tag)}`);
            const data = await res.json();

            const container = document.getElementById("tagResultsContainer");
            container.innerHTML = `<h2>#${tag} 관련 게시물</h2><ul>` +
            data.posts.map(post => `<li>${post.file_description}</li>`).join('') +
            `</ul>`;
        } catch (err) {
            console.error("❌ 클라이언트 오류:", err);
        }
        });
        </script>
    </body>
</html>