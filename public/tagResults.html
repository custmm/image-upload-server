<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="google-site-verification" content="kMxKqlA9cKbHdJGw51M2sE21fjyzL3SvY1ryWISJMT0" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>â±¯íœ´ìš±ìŠˆìš±â±¯ >> íƒœê·¸ê²°ê³¼</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      position: relative;
      margin: 0;
    }

    h2 {
      color: #1da1f2;
      margin-bottom: 20px;
      font-size: 1.2rem;
      text-align: center;
    }
    .post-item {
      display: flex;
      align-items: center;
      background: #f9f9f9;
      padding: 12px;
      margin-bottom: 15px;
      border-left: 4px solid #1da1f2;
      border-radius: 8px;
      gap: 15px;
      flex-wrap: wrap;
    }

    .post-item img {
      width: 90px;
      height: 90px;
      object-fit: cover;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .post-meta {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .category {
      font-weight: bold;
      font-size: 1rem;
      margin-bottom: 6px;
    }

    .desc {
      color: #444;
      font-size: 0.95rem;
      line-height: 1.4;
    }

    .post-meta a {
      text-decoration: none;
      color: inherit;
    }

    .post-meta a:hover {
      text-decoration: underline;
    }

    .post-list {
      list-style: none;
      padding: 0;
      margin-left: 50px;
      margin-right:50px;
    }

    .post-list li {
      background: #f7f7f7;
      padding: 15px;
      margin-bottom: 10px;
      border-left: 5px solid #1da1f2;
      border-radius: 4px;
    }

    .post-list li a {
      color: #333;
      text-decoration: none;
    }

    .post-list li a:hover {
      text-decoration: underline;
    }
  @media (max-width: 600px) {
    .post-item {
      flex-direction: row;
      align-items: center; /* âœ… ì¤‘ì•™ ì •ë ¬ë¡œ ìˆ˜ì • */
    }

    .post-item img {
      width: 60px;  /* â¬‡ï¸ ëª¨ë°”ì¼ì— ë§ê²Œ í¬ê¸° ì¶•ì†Œ */
      height: 60px;
    }
    .post-list{
      list-style: none;
      padding: 0;
      margin-left: 5px;
      margin-right: 5px;
    }

    .category {
      font-size: 0.9rem;
    }

    .desc {
      font-size: 0.85rem;
    }
  }
  </style>
</head>
<body>
    <button id="backToListButton" class="back-button">ë’¤ë¡œê°€ê¸°</button>
      <h2 id="tagTitle">#íƒœê·¸ ê´€ë ¨ ê²Œì‹œë¬¼</h2>
    <ul class="post-list" id="postList"></ul>

    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        const tag = new URLSearchParams(location.search).get("tag");
        const tagTitle = document.getElementById("tagTitle");
        const postList = document.getElementById("postList");

        if (!tag) {
          tagTitle.textContent = "âŒ íƒœê·¸ ì—†ìŒ";
          return;
        }

        tagTitle.textContent = `#${tag} ê´€ë ¨ ê²Œì‹œë¬¼`;

        try {
          const res = await fetch(`/api/search?tag=${encodeURIComponent(tag)}`);
          const data = await res.json();

          let posts = data.posts;

        // âœ… ë‹¨ì¼ ê°ì²´ í˜¹ì€ ë¹ˆ ê°ì²´ì¼ ë•Œ ë°°ì—´ë¡œ ì²˜ë¦¬
        if (!Array.isArray(posts)) {
          if (!posts || Object.keys(posts).length === 0) {
            posts = [];
          } else {
            posts = [posts];
          }
        }

          if (posts.length === 0) {
            postList.innerHTML = "<li>ê´€ë ¨ ê²Œì‹œë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</li>";
            return;
          }

        postList.innerHTML = posts.map(post => `
          <div class="post-item">
            <a href="post.html?file=${encodeURIComponent(post.file_name)}&category=${encodeURIComponent(post.category_name)}&subcategory=${encodeURIComponent(post.subcategory_name)}">
              <img src="${post.file_path}" alt="ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€">
            </a>
            <div class="post-meta">
              <div class="category">${post.category_name} â–¶ ${post.subcategory_name}</div>
              <div class="desc">
                <a href="post.html?file=${encodeURIComponent(post.file_name)}&category=${encodeURIComponent(post.category_name)}&subcategory=${encodeURIComponent(post.subcategory_name)}">
                  ${post.file_description.replace(/(<([^>]+)>)/gi, "").slice(0, 50)}...
                </a>
              </div>
            </div>
          </div>
        `).join('');
      } catch (err) {
        console.error("âŒ ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜:", err);
        postList.innerHTML = "<p>ê²€ìƒ‰ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>";
      }
    });
      // âœ… "ëª©ë¡ìœ¼ë¡œ" ë²„íŠ¼ í´ë¦­ ì‹œ ì´ì „ í˜ì´ì§€ë¡œ ì´ë™
      document.getElementById("backToListButton").addEventListener("click", () => {
        window.history.back(); // ğŸ”¥ ì´ì „ í˜ì´ì§€ë¡œ ì´ë™
      });
    </script>
    </body>
</html>